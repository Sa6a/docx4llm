# docx4llm

**docx4llm** — это библиотека Python и CLI‑утилита, предназначенная для подготовки `.docx`‑документов к дальнейшей обработке языковыми моделями (LLM) и другим ПО.
Основная задача — заменить встроенные нумерованные и маркированные списки Word на статичный текст с сохранением форматирования маркировки/нумерации. При необходимости библиотека может сконвертировать обработанный файл в другой формат c помощью Pandoc.

## Возможности

- **Очистка нумерации**: преобразует автоматические списки Word в обычный текст, добавляя префикс («1.», «a)», «•» и т. д.) непосредственно в абзацы.
- **Конвертация форматов (опционально)**: экспорт в Markdown (CommonMark, GFM), HTML, PDF (через LaTeX) и любой формат, поддерживаемый Pandoc.
- **Гибкая работа с изменениями и комментариями**: при конвертации можно принять (`accept`), отклонить (`reject`) или сохранить (`all`) все пометки _Track Changes_.
- **Интерактивный CLI**: поставляется скрипт `docx-num-converter`, который пошагово задаёт вопросы и отображает понятные сообщения.
- **Python API**: высокоуровневые функции `add_numbering_to_docx()` и `convert_docx_to_format()` для использования в своих скриптах.

## Требования

| Компонент         | Минимальная версия | Обязательно    | Назначение              |
| ----------------- | ------------------ | -------------- | ----------------------- |
| Python            | 3.12               | ✓              | интерпретатор           |
| `lxml`            | 5.3.2              | ✓ (авто)       | парсинг/модификация XML |
| `pypandoc`        | 1.15               | при экспорте   | обёртка над Pandoc      |
| **Pandoc**        | 2.17+              | при экспорте   | конвертация документов  |
| LaTeX дистрибутив | любой «полный»     | только для PDF | рендер PDF              |

## Установка

### Через uv

```bash
git clone https://github.com/Sa6a/docx4llm.git
cd docx4llm
uv sync --no-dev
```

См. официальную [инструкцию по установке uv](https://github.com/astral-sh/uv#installation) для способов установки на вашу платформу.

Убедитесь, что [Pandoc установлен и доступен в ](https://pandoc.org/installing.html)[`PATH`](https://pandoc.org/installing.html). Обратите внимание, что Pandoc не всегда корректно обрабатывает некоторые таблицы.

## Быстрый старт

### Интерактивная утилита

```bash
uv run docx-num-converter
```

Пример диалога (сокращён):

```
--- Обработчик нумерации DOCX ---
Введите полный путь к DOCX файлу для обработки: /path/to/input.docx
Файл будет обработан и сохранен как: /path/to/input_numbered.docx
...
Хотите сконвертировать обработанный DOCX файл в другой формат? (да/нет): да
Введите желаемый формат вывода: markdown
Введите режим отслеживания изменений (all/accept/reject, Enter для all):
...
Файл успешно сконвертирован и сохранен как: /path/to/input_numbered.md
```

### Использование из Python

```python
from docx4llm import add_numbering_to_docx, convert_docx_to_format

# 1. Добавить нумерацию прямо в текст
add_numbering_to_docx("input.docx", "input_numbered.docx")

# 2. Сконвертировать в Markdown, приняв все изменения
convert_docx_to_format(
    "input_numbered.docx",
    output_format="markdown",
    track_changes="accept"
)
```

## Содействие

Нашли баг или хотите предложить улучшение?
Создайте [Issue](../../issues) или отправьте Pull Request.

## Планы на развитие

1. **Рефакторинг ядра** — организация кода по принципам _чистой архитектуры_; строгая типизация `mypy`, линтеры `ruff` и `wps`, покрытие юнит‑ и интеграционными тестами.
2. **Собственная конвертация DOCX → JSON** — экспорт структуры документа вместе с комментариями и информацией об отслеживании изменений.
3. **Обратная конвертация JSON → DOCX** — восстановление Word‑документа из расширенного JSON‑представления.

## Лицензия

Проект распространяется под лицензией MIT. См. файл [LICENSE](LICENSE) для подробностей.
